{"version":3,"file":"upload.js","sourceRoot":"","sources":["../../src/node/upload.ts"],"names":[],"mappings":"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"}